{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/lib/utils.ts"],"sourcesContent":["/**\n * @File: src/lib/utils.ts\n */\n\n//src/lib/utils\nimport { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\nimport { customAlphabet } from \"nanoid\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Create a custom ID generator with nanoid\nexport const createId = customAlphabet(\n  \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",\n  12\n);\n"],"names":[],"mappings":"AAAA;;CAEC,GAED,eAAe;;;;;AACf;AACA;AACA;;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,uIAAA,CAAA,OAAI,AAAD,EAAE;AACtB;AAGO,MAAM,WAAW,CAAA,GAAA,iJAAA,CAAA,iBAAc,AAAD,EACnC,kEACA","debugId":null}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/lib/db/schema.ts"],"sourcesContent":["/**\n * @File: src/lib/db/schema.ts\n */\n\nimport {\n  sqliteTable,\n  text,\n  integer,\n  primaryKey,\n} from \"drizzle-orm/sqlite-core\";\nimport { relations, sql } from \"drizzle-orm\";\nimport type { InferSelectModel, InferInsertModel } from \"drizzle-orm\";\nimport { createId } from \"../utils\";\n\n// Define timestamp helpers\nconst timestamp = () => sql`(strftime('%s', 'now') * 1000)`;\n\nexport const users = sqliteTable(\"User\", {\n  // Updated table name to match the database\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  name: text(\"name\"),\n  email: text(\"email\").notNull().unique(),\n  emailVerified: integer(\"emailVerified\", { mode: \"timestamp_ms\" }), // Updated column name to match the database schema\n  image: text(\"image\"),\n  password: text(\"password\"),\n  role: text(\"role\", { enum: [\"USER\", \"ADMIN\"] })\n    .notNull()\n    .default(\"USER\"),\n  createdAt: integer(\"createdAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()),\n  updatedAt: integer(\"updatedAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()), // Updated column name to match the database schema\n});\n\nexport const accounts = sqliteTable(\n  \"accounts\",\n  {\n    id: text(\"id\")\n      .notNull()\n      .primaryKey()\n      .$defaultFn(() => createId()),\n    userId: text(\"user_id\")\n      .notNull()\n      .references(() => users.id, { onDelete: \"cascade\" }),\n    type: text(\"type\").notNull(),\n    provider: text(\"provider\").notNull(),\n    providerAccountId: text(\"provider_account_id\").notNull(),\n    refresh_token: text(\"refresh_token\"),\n    access_token: text(\"access_token\"),\n    expires_at: integer(\"expires_at\"),\n    token_type: text(\"token_type\"),\n    scope: text(\"scope\"),\n    id_token: text(\"id_token\"),\n    session_state: text(\"session_state\"),\n  },\n  (table) => ({\n    providerProviderAccountIdIndex: primaryKey(\n      table.provider,\n      table.providerAccountId\n    ),\n  })\n);\n\nexport const sessions = sqliteTable(\"sessions\", {\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  sessionToken: text(\"session_token\").notNull().unique(),\n  userId: text(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  expires: integer(\"expires\", { mode: \"timestamp_ms\" }).notNull(),\n});\n\nexport const verificationTokens = sqliteTable(\n  \"verification_tokens\",\n  {\n    identifier: text(\"identifier\").notNull(),\n    token: text(\"token\").notNull(),\n    expires: integer(\"expires\", { mode: \"timestamp_ms\" }).notNull(),\n  },\n  (table) => ({\n    compoundKey: primaryKey(table.identifier, table.token),\n  })\n);\n\n// Correct the 'isFeatured' column definition\nexport const posts = sqliteTable(\"posts\", {\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  title: text(\"title\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  content: text(\"content\").notNull(),\n  excerpt: text(\"excerpt\"),\n  featuredImage: text(\"featured_image\"),\n  status: text(\"status\", { enum: [\"DRAFT\", \"PUBLISHED\", \"ARCHIVED\"] })\n    .notNull()\n    .default(\"DRAFT\"),\n  publishedAt: integer(\"published_at\", { mode: \"timestamp_ms\" }),\n  metaDescription: text(\"meta_description\"),\n  metaKeywords: text(\"meta_keywords\"),\n  locale: text(\"locale\").notNull().default(\"en\"),\n  createdAt: integer(\"createdAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()),\n  updatedAt: integer(\"updatedAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()), // Updated column name to match the database schema\n  authorId: text(\"author_id\")\n    .notNull()\n    .references(() => users.id),\n  isFeatured: integer(\"is_featured\", { mode: \"boolean\" })\n    .notNull()\n    .default(sql`false`), // Corrected to use integer with boolean mode\n});\n\nexport const categories = sqliteTable(\"categories\", {\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  name: text(\"name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  description: text(\"description\"),\n  createdAt: integer(\"createdAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()),\n  updatedAt: integer(\"updatedAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()), // Updated column name to match the database schema\n});\n\nexport const categoriesOnPosts = sqliteTable(\n  \"categories_posts\",\n  {\n    postId: text(\"post_id\")\n      .notNull()\n      .references(() => posts.id),\n    categoryId: text(\"category_id\")\n      .notNull()\n      .references(() => categories.id),\n    assignedAt: integer(\"assigned_at\", { mode: \"timestamp_ms\" })\n      .notNull()\n      .default(timestamp()),\n  },\n  (table) => ({\n    pk: primaryKey(table.postId, table.categoryId),\n  })\n);\n\n// Define comments table with a nullable parentId for hierarchical comments\nexport const comments = sqliteTable(\"comments\", {\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  content: text(\"content\").notNull(),\n  createdAt: integer(\"createdAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()),\n  updatedAt: integer(\"updatedAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()), // Updated column name to match the database schema\n  postId: text(\"post_id\")\n    .notNull()\n    .references(() => posts.id, { onDelete: \"cascade\" }),\n  userId: text(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  parentId: text(\"parent_id\"),\n});\n\nexport const siteSettings = sqliteTable(\"site_settings\", {\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  title: text(\"title\").notNull().default(\"My Blog\"),\n  description: text(\"description\")\n    .notNull()\n    .default(\"A blog built with Next.js\"),\n  logo: text(\"logo\"),\n  favicon: text(\"favicon\"),\n  socialFacebook: text(\"social_facebook\"),\n  socialTwitter: text(\"social_twitter\"),\n  socialInstagram: text(\"social_instagram\"),\n  socialLinkedIn: text(\"social_linkedin\"),\n  socialGithub: text(\"social_github\"),\n  footerText: text(\"footer_text\"),\n  createdAt: integer(\"createdAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()),\n  updatedAt: integer(\"updatedAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()), // Updated column name to match the database schema\n});\n\n// Add media table\nexport const media = sqliteTable(\"media\", {\n  id: text(\"id\")\n    .notNull()\n    .primaryKey()\n    .$defaultFn(() => createId()),\n  filename: text(\"filename\").notNull(),\n  url: text(\"url\").notNull(),\n  thumbnailUrl: text(\"thumbnail_url\"),\n  size: integer(\"size\").notNull(),\n  width: integer(\"width\").notNull(),\n  height: integer(\"height\").notNull(),\n  type: text(\"type\").notNull(),\n  alt: text(\"alt\"),\n  createdAt: integer(\"createdAt\", { mode: \"timestamp_ms\" })\n    .notNull()\n    .default(timestamp()),\n  userId: text(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n});\n\n// Define relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  posts: many(posts),\n  comments: many(comments),\n  sessions: many(sessions),\n  accounts: many(accounts),\n  media: many(media),\n}));\n\nexport const postsRelations = relations(posts, ({ one, many }) => ({\n  author: one(users, {\n    fields: [posts.authorId],\n    references: [users.id],\n  }),\n  categories: many(categoriesOnPosts),\n  comments: many(comments),\n}));\n\nexport const categoriesRelations = relations(categories, ({ many }) => ({\n  posts: many(categoriesOnPosts),\n}));\n\nexport const categoriesOnPostsRelations = relations(\n  categoriesOnPosts,\n  ({ one }) => ({\n    post: one(posts, {\n      fields: [categoriesOnPosts.postId],\n      references: [posts.id],\n    }),\n    category: one(categories, {\n      fields: [categoriesOnPosts.categoryId],\n      references: [categories.id],\n    }),\n  })\n);\n\nexport const commentsRelations = relations(comments, ({ one, many }) => ({\n  post: one(posts, {\n    fields: [comments.postId],\n    references: [posts.id],\n  }),\n  user: one(users, {\n    fields: [comments.userId],\n    references: [users.id],\n  }),\n  parent: one(comments, {\n    fields: [comments.parentId],\n    references: [comments.id],\n  }),\n  replies: many(comments, {\n    relationName: \"comment_replies\",\n  }),\n}));\n\n// Types\nexport type User = InferSelectModel<typeof users>;\nexport type NewUser = InferInsertModel<typeof users>;\n\nexport type Post = InferSelectModel<typeof posts>;\nexport type NewPost = InferInsertModel<typeof posts>;\n\nexport type Category = InferSelectModel<typeof categories>;\nexport type NewCategory = InferInsertModel<typeof categories>;\n\nexport type Comment = InferSelectModel<typeof comments>;\nexport type NewComment = InferInsertModel<typeof comments>;\n\nexport type SiteSetting = InferSelectModel<typeof siteSettings>;\nexport type NewSiteSetting = InferInsertModel<typeof siteSettings>;\n\nexport type Media = InferSelectModel<typeof media>;\nexport type NewMedia = InferInsertModel<typeof media>;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 386, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/lib/db/index.ts"],"sourcesContent":["/**\n * @File: src/lib/db/index.ts\n */\n\nimport { drizzle } from \"drizzle-orm/better-sqlite3\";\nimport Database from \"better-sqlite3\";\nimport * as schema from \"./schema\";\nimport path from \"path\";\nimport fs from \"fs\";\n\n// تحديد المسار الصحيح - استخدم المسار المطلق\nconst dbPath = path.resolve(process.cwd(), 'prisma', 'dev.db');\n\n// تصحيح الأخطاء\nconsole.log('Database path:', dbPath);\n\n// تهيئة قاعدة البيانات\nconst initDB = () => {\n  try {\n    const dbDir = path.dirname(dbPath);\n    if (!fs.existsSync(dbDir)) {\n      fs.mkdirSync(dbDir, { recursive: true });\n    }\n    \n    if (!fs.existsSync(dbPath)) {\n      fs.writeFileSync(dbPath, '');\n    }\n\n    const sqlite = new Database(dbPath);\n    return drizzle(sqlite, { schema });\n  } catch (error) {\n    console.error('Database initialization error:', error);\n    throw error;\n  }\n};\n\nexport const db = initDB();"],"names":[],"mappings":"AAAA;;CAEC;;;AAED;AACA;AACA;AACA;AACA;;;;;;AAEA,6CAA6C;AAC7C,MAAM,SAAS,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI,UAAU;AAErD,gBAAgB;AAChB,QAAQ,GAAG,CAAC,kBAAkB;AAE9B,uBAAuB;AACvB,MAAM,SAAS;IACb,IAAI;QACF,MAAM,QAAQ,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,CAAC,6FAAA,CAAA,UAAE,CAAC,UAAU,CAAC,QAAQ;YACzB,6FAAA,CAAA,UAAE,CAAC,SAAS,CAAC,OAAO;gBAAE,WAAW;YAAK;QACxC;QAEA,IAAI,CAAC,6FAAA,CAAA,UAAE,CAAC,UAAU,CAAC,SAAS;YAC1B,6FAAA,CAAA,UAAE,CAAC,aAAa,CAAC,QAAQ;QAC3B;QAEA,MAAM,SAAS,IAAI,2HAAA,CAAA,UAAQ,CAAC;QAC5B,OAAO,CAAA,GAAA,+JAAA,CAAA,UAAO,AAAD,EAAE,QAAQ;YAAE,QAAA;QAAO;IAClC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,MAAM;IACR;AACF;AAEO,MAAM,KAAK","debugId":null}},
    {"offset": {"line": 433, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/lib/auth/service.ts"],"sourcesContent":["/**\n * @File: src/lib/auth/service.ts\n */\n\nimport bcrypt from \"bcryptjs\";\nimport { db } from \"../db\";\nimport { users } from \"../db/schema\";\nimport { createId } from \"../utils\";\nimport { eq } from \"drizzle-orm\";\nimport type { InferInsertModel } from \"drizzle-orm\";\n\nexport type RegisterUserData = {\n  name: string;\n  email: string;\n  password: string;\n  role?: \"USER\" | \"ADMIN\"; // Add role as an optional parameter\n};\n\nexport type UpdateUserData = {\n  name?: string;\n  email?: string;\n  password?: string;\n  image?: string;\n};\n\nexport async function registerUser(userData: RegisterUserData) {\n  // Check if user already exists\n  const existingUser = await db\n    .select()\n    .from(users)\n    .where(eq(users.email, userData.email))\n    .then((res) => res[0]);\n\n  if (existingUser) {\n    throw new Error(\"User already exists\");\n  }\n\n  // Hash password\n  const hashedPassword = await bcrypt.hash(userData.password, 10);\n\n  // Create user\n  await db.insert(users).values({\n    id: createId(),\n    name: userData.name,\n    email: userData.email,\n    password: hashedPassword,\n    role: userData.role || \"USER\", // Use the provided role or default to USER\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  });\n\n  return { success: true };\n}\n\nexport async function updateUser(userId: string, userData: UpdateUserData) {\n  const updateData: Partial<InferInsertModel<typeof users>> = {\n    updatedAt: new Date(),\n  };\n\n  if (userData.name) updateData.name = userData.name;\n  if (userData.email) updateData.email = userData.email;\n  if (userData.image) updateData.image = userData.image;\n\n  if (userData.password) {\n    updateData.password = await bcrypt.hash(userData.password, 10);\n  }\n\n  await db.update(users).set(updateData).where(eq(users.id, userId));\n  return { success: true };\n}\n\nexport async function getUser(userId: string) {\n  const user = await db\n    .select({\n      id: users.id,\n      name: users.name,\n      email: users.email,\n      image: users.image,\n      role: users.role,\n      createdAt: users.createdAt,\n    })\n    .from(users)\n    .where(eq(users.id, userId))\n    .then((res) => res[0] || null);\n\n  return user;\n}\n\nexport async function getUserByEmail(email: string) {\n  const user = await db\n    .select({\n      id: users.id,\n      name: users.name,\n      email: users.email,\n      image: users.image,\n      role: users.role,\n      createdAt: users.createdAt,\n    })\n    .from(users)\n    .where(eq(users.email, email))\n    .then((res) => res[0] || null);\n\n  return user;\n}\n\nexport async function makeUserAdmin(userId: string) {\n  await db.update(users).set({ role: \"ADMIN\" }).where(eq(users.id, userId));\n  return { success: true };\n}\n\n// Add function to create first admin user (for initial setup)\nexport async function createRootAdmin(userData: RegisterUserData) {\n  // Check if any admin user already exists\n  const existingAdmin = await db\n    .select()\n    .from(users)\n    .where(eq(users.role, \"ADMIN\"))\n    .then((res) => res[0]);\n\n  if (existingAdmin) {\n    throw new Error(\"Root admin already exists\");\n  }\n\n  // Hash password\n  const hashedPassword = await bcrypt.hash(userData.password, 10);\n\n  // Create admin user\n  await db.insert(users).values({\n    id: createId(),\n    name: userData.name,\n    email: userData.email,\n    password: hashedPassword,\n    role: \"ADMIN\",\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  });\n\n  return { success: true };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 628, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/lib/auth/drizzle-adapter.ts"],"sourcesContent":["/**\n * @File: src/lib/auth/drizzle-adapter.ts\n */\n\nimport { and, eq } from \"drizzle-orm\";\nimport type { Adapter, AdapterAccount, AdapterSession, AdapterUser, VerificationToken } from \"next-auth/adapters\";\nimport { db } from \"@/lib/db\"; // تأكد من استخدام المسار الصحيح\nimport { accounts, sessions, users, verificationTokens } from \"@/lib/db/schema\";\nimport { createId } from \"@/lib/utils\";\n\nexport function DrizzleAdapter(client: typeof db): Adapter {\n  return {\n    async createUser(userData: Omit<AdapterUser, \"id\">): Promise<AdapterUser> {\n      const id = createId();\n      await client.insert(users).values({\n        id,\n        email: userData.email,\n        emailVerified: userData.emailVerified,\n        name: userData.name,\n        image: userData.image,\n      });\n\n      const [user] = await client\n        .select()\n        .from(users)\n        .where(eq(users.id, id))\n        .limit(1);\n\n      return user;\n    },\n\n    async getUser(id: string): Promise<AdapterUser | null> {\n      const user = await db\n        .select()\n        .from(users)\n        .where(eq(users.id, id))\n        .then((res) => res[0] || null);\n\n      return user;\n    },\n\n    async getUserByEmail(email: string): Promise<AdapterUser | null> {\n      const user = await db\n        .select()\n        .from(users)\n        .where(eq(users.email, email))\n        .then((res) => res[0] || null);\n\n      return user;\n    },\n\n    async getUserByAccount({ providerAccountId, provider }: { providerAccountId: string; provider: string }): Promise<AdapterUser | null> {\n      const account = await db\n        .select()\n        .from(accounts)\n        .where(\n          and(\n            eq(accounts.providerAccountId, providerAccountId),\n            eq(accounts.provider, provider)\n          )\n        )\n        .then((res) => res[0]);\n\n      if (!account) {\n        return null;\n      }\n\n      const user = await db\n        .select()\n        .from(users)\n        .where(eq(users.id, account.userId))\n        .then((res) => res[0]);\n\n      return user || null;\n    },\n\n    async updateUser(user: Partial<AdapterUser> & { id: string }): Promise<AdapterUser> {\n      await db\n        .update(users)\n        .set({\n          name: user.name,\n          email: user.email,\n          image: user.image,\n          emailVerified: user.emailVerified,\n        })\n        .where(eq(users.id, user.id));\n\n      const updatedUser = await db\n        .select()\n        .from(users)\n        .where(eq(users.id, user.id))\n        .then((res) => res[0]);\n\n      return updatedUser;\n    },\n\n    async deleteUser(userId: string): Promise<void> {\n      await db.delete(users).where(eq(users.id, userId));\n    },\n\n    async linkAccount(account: AdapterAccount): Promise<void> {\n      await db.insert(accounts).values({\n        id: createId(),\n        userId: account.userId,\n        type: account.type,\n        provider: account.provider,\n        providerAccountId: account.providerAccountId,\n        refresh_token: account.refresh_token,\n        access_token: account.access_token,\n        expires_at: account.expires_at,\n        token_type: account.token_type,\n        scope: account.scope,\n        id_token: account.id_token,\n        session_state: account.session_state,\n      });\n    },\n\n    async unlinkAccount({ providerAccountId, provider }: { providerAccountId: string; provider: string }): Promise<void> {\n      await db\n        .delete(accounts)\n        .where(\n          and(\n            eq(accounts.providerAccountId, providerAccountId),\n            eq(accounts.provider, provider)\n          )\n        );\n    },\n\n    async createSession(session: { sessionToken: string; userId: string; expires: Date }): Promise<AdapterSession> {\n      await db.insert(sessions).values({\n        id: createId(),\n        userId: session.userId,\n        sessionToken: session.sessionToken,\n        expires: session.expires,\n      });\n\n      const createdSession = await db\n        .select()\n        .from(sessions)\n        .where(eq(sessions.sessionToken, session.sessionToken))\n        .then((res) => res[0]);\n\n      return createdSession;\n    },\n\n    async getSessionAndUser(sessionToken: string): Promise<{ session: AdapterSession; user: AdapterUser } | null> {\n      const session = await db\n        .select()\n        .from(sessions)\n        .where(eq(sessions.sessionToken, sessionToken))\n        .then((res) => res[0]);\n\n      if (!session) {\n        return null;\n      }\n\n      const user = await db\n        .select()\n        .from(users)\n        .where(eq(users.id, session.userId))\n        .then((res) => res[0]);\n\n      if (!user) {\n        return null;\n      }\n\n      return {\n        session,\n        user,\n      };\n    },\n\n    async updateSession(session: Partial<AdapterSession> & { sessionToken: string }): Promise<AdapterSession | null> {\n      await db\n        .update(sessions)\n        .set({\n          expires: session.expires,\n        })\n        .where(eq(sessions.sessionToken, session.sessionToken));\n\n      const updatedSession = await db\n        .select()\n        .from(sessions)\n        .where(eq(sessions.sessionToken, session.sessionToken))\n        .then((res) => res[0] || null);\n\n      return updatedSession;\n    },\n\n    async deleteSession(sessionToken: string): Promise<void> {\n      await db.delete(sessions).where(eq(sessions.sessionToken, sessionToken));\n    },\n\n    async createVerificationToken(verificationToken: VerificationToken): Promise<VerificationToken> {\n      await db.insert(verificationTokens).values({\n        identifier: verificationToken.identifier,\n        token: verificationToken.token,\n        expires: verificationToken.expires,\n      });\n\n      const token = await db\n        .select()\n        .from(verificationTokens)\n        .where(\n          and(\n            eq(verificationTokens.identifier, verificationToken.identifier),\n            eq(verificationTokens.token, verificationToken.token)\n          )\n        )\n        .then((res) => res[0]);\n\n      return token;\n    },\n\n    async useVerificationToken({ identifier, token }: { identifier: string; token: string }): Promise<VerificationToken | null> {\n      const verificationToken = await db\n        .select()\n        .from(verificationTokens)\n        .where(\n          and(\n            eq(verificationTokens.identifier, identifier),\n            eq(verificationTokens.token, token)\n          )\n        )\n        .then((res) => res[0] || null);\n\n      if (!verificationToken) {\n        return null;\n      }\n\n      await db\n        .delete(verificationTokens)\n        .where(\n          and(\n            eq(verificationTokens.identifier, identifier),\n            eq(verificationTokens.token, token)\n          )\n        );\n\n      return verificationToken;\n    },\n  };\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;AAED;AAEA,qNAA+B,gCAAgC;AAC/D;AACA;;;;;AAEO,SAAS,eAAe,MAAiB;IAC9C,OAAO;QACL,MAAM,YAAW,QAAiC;YAChD,MAAM,KAAK,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;YAClB,MAAM,OAAO,MAAM,CAAC,4HAAA,CAAA,QAAK,EAAE,MAAM,CAAC;gBAChC;gBACA,OAAO,SAAS,KAAK;gBACrB,eAAe,SAAS,aAAa;gBACrC,MAAM,SAAS,IAAI;gBACnB,OAAO,SAAS,KAAK;YACvB;YAEA,MAAM,CAAC,KAAK,GAAG,MAAM,OAClB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE,KACnB,KAAK,CAAC;YAET,OAAO;QACT;QAEA,MAAM,SAAQ,EAAU;YACtB,MAAM,OAAO,MAAM,2HAAA,CAAA,KAAE,CAClB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE,KACnB,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE,IAAI;YAE3B,OAAO;QACT;QAEA,MAAM,gBAAe,KAAa;YAChC,MAAM,OAAO,MAAM,2HAAA,CAAA,KAAE,CAClB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,KAAK,EAAE,QACtB,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE,IAAI;YAE3B,OAAO;QACT;QAEA,MAAM,kBAAiB,EAAE,iBAAiB,EAAE,QAAQ,EAAmD;YACrG,MAAM,UAAU,MAAM,2HAAA,CAAA,KAAE,CACrB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,WAAQ,EACb,KAAK,CACJ,CAAA,GAAA,oKAAA,CAAA,MAAG,AAAD,EACA,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,iBAAiB,EAAE,oBAC/B,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,QAAQ,EAAE,YAGzB,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,IAAI,CAAC,SAAS;gBACZ,OAAO;YACT;YAEA,MAAM,OAAO,MAAM,2HAAA,CAAA,KAAE,CAClB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE,QAAQ,MAAM,GACjC,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,OAAO,QAAQ;QACjB;QAEA,MAAM,YAAW,IAA2C;YAC1D,MAAM,2HAAA,CAAA,KAAE,CACL,MAAM,CAAC,4HAAA,CAAA,QAAK,EACZ,GAAG,CAAC;gBACH,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;gBACjB,OAAO,KAAK,KAAK;gBACjB,eAAe,KAAK,aAAa;YACnC,GACC,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE,KAAK,EAAE;YAE7B,MAAM,cAAc,MAAM,2HAAA,CAAA,KAAE,CACzB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE,KAAK,EAAE,GAC1B,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,OAAO;QACT;QAEA,MAAM,YAAW,MAAc;YAC7B,MAAM,2HAAA,CAAA,KAAE,CAAC,MAAM,CAAC,4HAAA,CAAA,QAAK,EAAE,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE;QAC5C;QAEA,MAAM,aAAY,OAAuB;YACvC,MAAM,2HAAA,CAAA,KAAE,CAAC,MAAM,CAAC,4HAAA,CAAA,WAAQ,EAAE,MAAM,CAAC;gBAC/B,IAAI,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;gBACX,QAAQ,QAAQ,MAAM;gBACtB,MAAM,QAAQ,IAAI;gBAClB,UAAU,QAAQ,QAAQ;gBAC1B,mBAAmB,QAAQ,iBAAiB;gBAC5C,eAAe,QAAQ,aAAa;gBACpC,cAAc,QAAQ,YAAY;gBAClC,YAAY,QAAQ,UAAU;gBAC9B,YAAY,QAAQ,UAAU;gBAC9B,OAAO,QAAQ,KAAK;gBACpB,UAAU,QAAQ,QAAQ;gBAC1B,eAAe,QAAQ,aAAa;YACtC;QACF;QAEA,MAAM,eAAc,EAAE,iBAAiB,EAAE,QAAQ,EAAmD;YAClG,MAAM,2HAAA,CAAA,KAAE,CACL,MAAM,CAAC,4HAAA,CAAA,WAAQ,EACf,KAAK,CACJ,CAAA,GAAA,oKAAA,CAAA,MAAG,AAAD,EACA,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,iBAAiB,EAAE,oBAC/B,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,QAAQ,EAAE;QAG9B;QAEA,MAAM,eAAc,OAAgE;YAClF,MAAM,2HAAA,CAAA,KAAE,CAAC,MAAM,CAAC,4HAAA,CAAA,WAAQ,EAAE,MAAM,CAAC;gBAC/B,IAAI,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;gBACX,QAAQ,QAAQ,MAAM;gBACtB,cAAc,QAAQ,YAAY;gBAClC,SAAS,QAAQ,OAAO;YAC1B;YAEA,MAAM,iBAAiB,MAAM,2HAAA,CAAA,KAAE,CAC5B,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,WAAQ,EACb,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,YAAY,EAAE,QAAQ,YAAY,GACpD,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,OAAO;QACT;QAEA,MAAM,mBAAkB,YAAoB;YAC1C,MAAM,UAAU,MAAM,2HAAA,CAAA,KAAE,CACrB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,WAAQ,EACb,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,YAAY,EAAE,eAChC,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,IAAI,CAAC,SAAS;gBACZ,OAAO;YACT;YAEA,MAAM,OAAO,MAAM,2HAAA,CAAA,KAAE,CAClB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,EAAE,EAAE,QAAQ,MAAM,GACjC,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,IAAI,CAAC,MAAM;gBACT,OAAO;YACT;YAEA,OAAO;gBACL;gBACA;YACF;QACF;QAEA,MAAM,eAAc,OAA2D;YAC7E,MAAM,2HAAA,CAAA,KAAE,CACL,MAAM,CAAC,4HAAA,CAAA,WAAQ,EACf,GAAG,CAAC;gBACH,SAAS,QAAQ,OAAO;YAC1B,GACC,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,YAAY,EAAE,QAAQ,YAAY;YAEvD,MAAM,iBAAiB,MAAM,2HAAA,CAAA,KAAE,CAC5B,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,WAAQ,EACb,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,YAAY,EAAE,QAAQ,YAAY,GACpD,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE,IAAI;YAE3B,OAAO;QACT;QAEA,MAAM,eAAc,YAAoB;YACtC,MAAM,2HAAA,CAAA,KAAE,CAAC,MAAM,CAAC,4HAAA,CAAA,WAAQ,EAAE,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,WAAQ,CAAC,YAAY,EAAE;QAC5D;QAEA,MAAM,yBAAwB,iBAAoC;YAChE,MAAM,2HAAA,CAAA,KAAE,CAAC,MAAM,CAAC,4HAAA,CAAA,qBAAkB,EAAE,MAAM,CAAC;gBACzC,YAAY,kBAAkB,UAAU;gBACxC,OAAO,kBAAkB,KAAK;gBAC9B,SAAS,kBAAkB,OAAO;YACpC;YAEA,MAAM,QAAQ,MAAM,2HAAA,CAAA,KAAE,CACnB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,qBAAkB,EACvB,KAAK,CACJ,CAAA,GAAA,oKAAA,CAAA,MAAG,AAAD,EACA,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,qBAAkB,CAAC,UAAU,EAAE,kBAAkB,UAAU,GAC9D,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,qBAAkB,CAAC,KAAK,EAAE,kBAAkB,KAAK,IAGvD,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;YAEvB,OAAO;QACT;QAEA,MAAM,sBAAqB,EAAE,UAAU,EAAE,KAAK,EAAyC;YACrF,MAAM,oBAAoB,MAAM,2HAAA,CAAA,KAAE,CAC/B,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,qBAAkB,EACvB,KAAK,CACJ,CAAA,GAAA,oKAAA,CAAA,MAAG,AAAD,EACA,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,qBAAkB,CAAC,UAAU,EAAE,aAClC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,qBAAkB,CAAC,KAAK,EAAE,SAGhC,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE,IAAI;YAE3B,IAAI,CAAC,mBAAmB;gBACtB,OAAO;YACT;YAEA,MAAM,2HAAA,CAAA,KAAE,CACL,MAAM,CAAC,4HAAA,CAAA,qBAAkB,EACzB,KAAK,CACJ,CAAA,GAAA,oKAAA,CAAA,MAAG,AAAD,EACA,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,qBAAkB,CAAC,UAAU,EAAE,aAClC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,qBAAkB,CAAC,KAAK,EAAE;YAInC,OAAO;QACT;IACF;AACF","debugId":null}},
    {"offset": {"line": 762, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/lib/auth/config.ts"],"sourcesContent":["/**\n * @File: src/lib/auth/config.ts\n */\n\nimport type { NextAuthOptions } from \"next-auth\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\nimport GithubProvider from \"next-auth/providers/github\";\nimport GoogleProvider from \"next-auth/providers/google\";\nimport bcrypt from \"bcryptjs\";\nimport { DrizzleAdapter } from \"./drizzle-adapter\";\nimport { db } from \"@/lib/db\";\nimport { users } from \"@/lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\n\nexport const authOptions: NextAuthOptions = {\n  debug: process.env.NODE_ENV === \"development\",\n  secret: process.env.NEXTAUTH_SECRET,\n  adapter: DrizzleAdapter(db),\n  session: {\n    strategy: \"jwt\",\n    maxAge: 30 * 24 * 60 * 60,\n  },\n  providers: [\n    GithubProvider({\n      clientId: process.env.GITHUB_CLIENT_ID || \"\",\n      clientSecret: process.env.GITHUB_CLIENT_SECRET || \"\",\n    }),\n    GoogleProvider({\n      clientId: process.env.GOOGLE_CLIENT_ID || \"\",\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"\",\n    }),\n    CredentialsProvider({\n      \n      name: \"credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        if (credentials?.email === \"test@example.com\") {\n          return {\n            id: \"test-user\",\n            email: \"test@example.com\",\n            name: \"Test User\",\n            role: \"ADMIN\"\n          };\n        }\n        try {\n          if (!credentials?.email || !credentials?.password) {\n            throw new Error('Email and password are required');\n          }\n      \n          const user = await db\n            .select()\n            .from(users)\n            .where(eq(users.email, credentials.email))\n            .then((res) => res[0]);\n      \n          if (!user) {\n            throw new Error('User not found');\n          }\n      \n          if (!user.password) {\n            throw new Error('User registered with OAuth');\n          }\n      \n          const isValid = await bcrypt.compare(\n            credentials.password,\n            user.password\n          );\n      \n          if (!isValid) {\n            throw new Error('Invalid password');\n          }\n      \n          return {\n            id: user.id,\n            email: user.email,\n            name: user.name,\n            image: user.image,\n            role: user.role,\n          };\n        } catch (error) {\n          console.error(\"Authorization error:\", error);\n          return null;\n        }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      console.log(token, user, \"authOptions\" );\n      \n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      if (token?.id) session.user.id = token.id;\n      if (token?.role) session.user.role = token.role;\n      return session;\n    },\n  },\n  pages: {\n    signIn: \"/login\",\n    error: \"/login\",\n  },\n};"],"names":[],"mappings":"AAAA;;CAEC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AAEO,MAAM,cAA+B;IAC1C,OAAO,oDAAyB;IAChC,QAAQ,QAAQ,GAAG,CAAC,eAAe;IACnC,SAAS,CAAA,GAAA,0IAAA,CAAA,iBAAc,AAAD,EAAE,2HAAA,CAAA,KAAE;IAC1B,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,WAAW;QACT,CAAA,GAAA,qJAAA,CAAA,UAAc,AAAD,EAAE;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB,IAAI;YAC1C,cAAc,QAAQ,GAAG,CAAC,oBAAoB,IAAI;QACpD;QACA,CAAA,GAAA,qJAAA,CAAA,UAAc,AAAD,EAAE;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB,IAAI;YAC1C,cAAc,QAAQ,GAAG,CAAC,oBAAoB,IAAI;QACpD;QACA,CAAA,GAAA,0JAAA,CAAA,UAAmB,AAAD,EAAE;YAElB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,aAAa,UAAU,oBAAoB;oBAC7C,OAAO;wBACL,IAAI;wBACJ,OAAO;wBACP,MAAM;wBACN,MAAM;oBACR;gBACF;gBACA,IAAI;oBACF,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;wBACjD,MAAM,IAAI,MAAM;oBAClB;oBAEA,MAAM,OAAO,MAAM,2HAAA,CAAA,KAAE,CAClB,MAAM,GACN,IAAI,CAAC,4HAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,4HAAA,CAAA,QAAK,CAAC,KAAK,EAAE,YAAY,KAAK,GACvC,IAAI,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;oBAEvB,IAAI,CAAC,MAAM;wBACT,MAAM,IAAI,MAAM;oBAClB;oBAEA,IAAI,CAAC,KAAK,QAAQ,EAAE;wBAClB,MAAM,IAAI,MAAM;oBAClB;oBAEA,MAAM,UAAU,MAAM,mIAAA,CAAA,UAAM,CAAC,OAAO,CAClC,YAAY,QAAQ,EACpB,KAAK,QAAQ;oBAGf,IAAI,CAAC,SAAS;wBACZ,MAAM,IAAI,MAAM;oBAClB;oBAEA,OAAO;wBACL,IAAI,KAAK,EAAE;wBACX,OAAO,KAAK,KAAK;wBACjB,MAAM,KAAK,IAAI;wBACf,OAAO,KAAK,KAAK;wBACjB,MAAM,KAAK,IAAI;oBACjB;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,wBAAwB;oBACtC,OAAO;gBACT;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,QAAQ,GAAG,CAAC,OAAO,MAAM;YAEzB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,OAAO,IAAI,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;YACzC,IAAI,OAAO,MAAM,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAC/C,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 876, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pc/Desktop/fixed-blog%20-%20Copy/src/app/api/auth/register/route.ts"],"sourcesContent":["/**\n * @File: src/app/api/auth/register/route.ts\n */\n\nimport { registerUser } from \"@/lib/auth/service\";\nimport { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { getServerSession } from \"next-auth\";\nimport { authOptions } from \"@/lib/auth/config\";\n\n// Define validation schema\nconst registerSchema = z.object({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  role: z.enum([\"USER\", \"ADMIN\"]).optional().default(\"USER\"),\n});\n\nexport async function POST(req: NextRequest) {\n  try {\n    // Get the current session to check if the user is an admin\n    const session = await getServerSession(authOptions);\n\n    // Only allow admin users to register new accounts\n    if (!session || session.user.role !== \"ADMIN\") {\n      return NextResponse.json(\n        { error: \"Unauthorized: Only admins can create new accounts\" },\n        { status: 403 }\n      );\n    }\n\n    // Parse request body\n    const body = await req.json();\n\n    // Validate request data\n    const result = registerSchema.safeParse(body);\n\n    if (!result.success) {\n      return NextResponse.json(\n        { error: \"Invalid input\", details: result.error.flatten() },\n        { status: 400 }\n      );\n    }\n\n    // Register the user\n    await registerUser(result.data);\n\n    return NextResponse.json(\n      { success: true, message: \"User registered successfully\" },\n      { status: 201 }\n    );\n  } catch (error) {\n    console.error(\"Registration error:\", error);\n\n    if (error instanceof Error && error.message === \"User already exists\") {\n      return NextResponse.json(\n        { error: \"User already exists with this email\" },\n        { status: 409 }\n      );\n    }\n\n    return NextResponse.json(\n      { error: \"Registration failed\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;AAED;AACA;AACA;AACA;AACA;;;;;;AAEA,2BAA2B;AAC3B,MAAM,iBAAiB,sIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC9B,MAAM,sIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,sIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,sIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,MAAM,sIAAA,CAAA,IAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;KAAQ,EAAE,QAAQ,GAAG,OAAO,CAAC;AACrD;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,2DAA2D;QAC3D,MAAM,UAAU,MAAM,CAAA,GAAA,uIAAA,CAAA,mBAAgB,AAAD,EAAE,8HAAA,CAAA,cAAW;QAElD,kDAAkD;QAClD,IAAI,CAAC,WAAW,QAAQ,IAAI,CAAC,IAAI,KAAK,SAAS;YAC7C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoD,GAC7D;gBAAE,QAAQ;YAAI;QAElB;QAEA,qBAAqB;QACrB,MAAM,OAAO,MAAM,IAAI,IAAI;QAE3B,wBAAwB;QACxB,MAAM,SAAS,eAAe,SAAS,CAAC;QAExC,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;gBAAiB,SAAS,OAAO,KAAK,CAAC,OAAO;YAAG,GAC1D;gBAAE,QAAQ;YAAI;QAElB;QAEA,oBAAoB;QACpB,MAAM,CAAA,GAAA,+HAAA,CAAA,eAAY,AAAD,EAAE,OAAO,IAAI;QAE9B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAM,SAAS;QAA+B,GACzD;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QAErC,IAAI,iBAAiB,SAAS,MAAM,OAAO,KAAK,uBAAuB;YACrE,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsC,GAC/C;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAsB,GAC/B;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}